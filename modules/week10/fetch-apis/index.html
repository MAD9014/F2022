<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>10.2 Remote APIs | MAD9014</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Cross-Platform Application Development">
    
    <link rel="preload" href="/F2022/assets/css/0.styles.50f415bc.css" as="style"><link rel="preload" href="/F2022/assets/js/app.42156b92.js" as="script"><link rel="preload" href="/F2022/assets/js/2.309c8f6c.js" as="script"><link rel="preload" href="/F2022/assets/js/24.f984b5df.js" as="script"><link rel="preload" href="/F2022/assets/js/4.8f0492b2.js" as="script"><link rel="preload" href="/F2022/assets/js/6.42129677.js" as="script"><link rel="prefetch" href="/F2022/assets/js/10.6ed74506.js"><link rel="prefetch" href="/F2022/assets/js/11.e4e57652.js"><link rel="prefetch" href="/F2022/assets/js/12.4fd9334c.js"><link rel="prefetch" href="/F2022/assets/js/13.d60171d2.js"><link rel="prefetch" href="/F2022/assets/js/14.ef5f94d3.js"><link rel="prefetch" href="/F2022/assets/js/15.89cba5d1.js"><link rel="prefetch" href="/F2022/assets/js/16.07b0adef.js"><link rel="prefetch" href="/F2022/assets/js/17.274ce64a.js"><link rel="prefetch" href="/F2022/assets/js/18.83156930.js"><link rel="prefetch" href="/F2022/assets/js/19.dd8c0299.js"><link rel="prefetch" href="/F2022/assets/js/20.905940c5.js"><link rel="prefetch" href="/F2022/assets/js/21.0ecc185a.js"><link rel="prefetch" href="/F2022/assets/js/22.8c4f615d.js"><link rel="prefetch" href="/F2022/assets/js/23.cbd124fb.js"><link rel="prefetch" href="/F2022/assets/js/25.cae0bd53.js"><link rel="prefetch" href="/F2022/assets/js/26.171c675d.js"><link rel="prefetch" href="/F2022/assets/js/27.b6b19a01.js"><link rel="prefetch" href="/F2022/assets/js/28.762bb28a.js"><link rel="prefetch" href="/F2022/assets/js/29.ba3d8131.js"><link rel="prefetch" href="/F2022/assets/js/3.0ff4921b.js"><link rel="prefetch" href="/F2022/assets/js/30.9f8ef05e.js"><link rel="prefetch" href="/F2022/assets/js/31.b43b0ef2.js"><link rel="prefetch" href="/F2022/assets/js/32.c63a796c.js"><link rel="prefetch" href="/F2022/assets/js/33.b7b22e5a.js"><link rel="prefetch" href="/F2022/assets/js/34.410d0f9e.js"><link rel="prefetch" href="/F2022/assets/js/35.b935e2dc.js"><link rel="prefetch" href="/F2022/assets/js/36.27336e61.js"><link rel="prefetch" href="/F2022/assets/js/37.62aa130b.js"><link rel="prefetch" href="/F2022/assets/js/38.3da4e238.js"><link rel="prefetch" href="/F2022/assets/js/39.ffcb03f3.js"><link rel="prefetch" href="/F2022/assets/js/40.b0afee99.js"><link rel="prefetch" href="/F2022/assets/js/41.eeb38dd7.js"><link rel="prefetch" href="/F2022/assets/js/42.2e322fc2.js"><link rel="prefetch" href="/F2022/assets/js/43.3d75d1e0.js"><link rel="prefetch" href="/F2022/assets/js/44.d343e4db.js"><link rel="prefetch" href="/F2022/assets/js/45.35ad5dce.js"><link rel="prefetch" href="/F2022/assets/js/46.17dcf00b.js"><link rel="prefetch" href="/F2022/assets/js/5.71716d92.js"><link rel="prefetch" href="/F2022/assets/js/7.ea52c00d.js"><link rel="prefetch" href="/F2022/assets/js/8.78988ea0.js"><link rel="prefetch" href="/F2022/assets/js/9.2c22e4b4.js">
    <link rel="stylesheet" href="/F2022/assets/css/0.styles.50f415bc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/F2022/" class="home-link router-link-active"><img src="/F2022/mad-d-logo-sm.png" alt="MAD9014" class="logo"> <span class="site-name can-hide">MAD9014</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/F2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/F2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/F2022/conventions/" class="nav-link">
  Conventions
</a></div><div class="nav-item"><a href="/F2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/F2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/F2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/F2022/conventions/" class="nav-link">
  Conventions
</a></div><div class="nav-item"><a href="/F2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/F2022/modules/week1/intro/" class="sidebar-link">1.1: Introduction</a></li><li><a href="/F2022/modules/week2/functions/" class="sidebar-link">2.1: Functions and Scope</a></li><li><a href="/F2022/modules/week2/flow-strings/" class="sidebar-link">2.2: Truthiness, Control Flow and Strings</a></li><li><a href="/F2022/modules/week3/math-numbers/" class="sidebar-link">3.1: Math and Numbers</a></li><li><a href="/F2022/modules/week3/dates-loops/" class="sidebar-link">3.2: Dates and Loops</a></li><li><a href="/F2022/modules/week4/arrays/" class="sidebar-link">4.1: Arrays</a></li><li><a href="/F2022/modules/week4/objects/" class="sidebar-link">4.2: Objects</a></li><li><a href="/F2022/modules/week5/dom-1/" class="sidebar-link">5.1: Document Object Model</a></li><li><a href="/F2022/modules/week5/dom-2/" class="sidebar-link">5.2: Document Object Model</a></li><li><a href="/F2022/modules/week6/events/" class="sidebar-link">6.1: Handling Events</a></li><li><a href="/F2022/modules/week7/project-structure/" class="sidebar-link">7.1: Project Structure</a></li><li><a href="/F2022/modules/week7/code-structure/" class="sidebar-link">7.2: Code Structure</a></li><li><a href="/F2022/modules/reading/" class="sidebar-link">8: Reading Week</a></li><li><a href="/F2022/modules/week9/promises/" class="sidebar-link">9.1: Promises</a></li><li><a href="/F2022/modules/week9/async/" class="sidebar-link">9.2: Asynchronous Programming</a></li><li><a href="/F2022/modules/week10/ajax/" class="sidebar-link">10.1: AJAX and Fetch</a></li><li><a href="/F2022/modules/week10/fetch-apis/" aria-current="page" class="active sidebar-link">10.2: Fetch and APIs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#fetch" class="sidebar-link">Fetch</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#ide-api-library-framework-and-sdk" class="sidebar-link">IDE, API, Library, Framework, and SDK</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#jsonplaceholder" class="sidebar-link">JSONPlaceHolder</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#randomfox" class="sidebar-link">RandomFox</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#randomdog" class="sidebar-link">RandomDog</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#creating-dynamic-content" class="sidebar-link">Creating Dynamic Content</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#reddit-rest-api" class="sidebar-link">Reddit REST API</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#github-rest-api" class="sidebar-link">Github REST API</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#http-cat" class="sidebar-link">Http Cat</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#the-cat-api" class="sidebar-link">The Cat API</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#download-progress" class="sidebar-link">Download Progress</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week10/fetch-apis/#what-to-do-this-week" class="sidebar-link">What to do this week</a></li></ul></li><li><a href="/F2022/modules/week11/fetch-data/" class="sidebar-link">11.1: Dynamic Data</a></li><li><a href="/F2022/modules/week11/security/" class="sidebar-link">11.2: Fetch Security</a></li><li><a href="/F2022/modules/week12/observers/" class="sidebar-link">12.1: Observers &amp; Classes</a></li><li><a href="/F2022/modules/week12/destructure/" class="sidebar-link">12.2: Destructuring, Spead, &amp; Enumeration</a></li><li><a href="/F2022/modules/week13/storage/" class="sidebar-link">13.1: HTML5 APIs</a></li><li><a href="/F2022/modules/week13/multi-page/" class="sidebar-link">13.2: Multi-Page, SPA, and JAMStack </a></li><li><a href="/F2022/modules/week14/project-1/" class="sidebar-link">14.1: Forms &amp; Page Transitions</a></li><li><a href="/F2022/modules/week14/project-2/" class="sidebar-link">14.2: Final Project</a></li><li><a href="/F2022/modules/week15/" class="sidebar-link">15.1: Final Project</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title green">
    Programming with APIs
  </div> <h1>10.2 Remote APIs</h1></header> <h2 id="fetch"><a href="#fetch" class="header-anchor">#</a> Fetch</h2> <p>So, now that you are aware of all the parts of the world of <code>fetch</code>, let's start to use the <code>fetch()</code> method and talk to
some real APIs.</p> <p>There are a few ways that the initial <code>fetch</code> method call can be made depending on how much information you need to pass
and what needs to be customized.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1. send a string to the fetch method</span>
<span class="token keyword">let</span> urlString <span class="token operator">=</span> <span class="token string">'http://www.example.com/api'</span><span class="token punctuation">;</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>urlString<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//uses GET as the default method. No extra headers set. No data being sent to the server</span>

<span class="token comment">//2. send a URL object to the fetch method</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//same as version 1</span>

<span class="token comment">//3. send a Request Object that contains the url</span>
<span class="token keyword">let</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Request object can also have an options param with data and headers and non-GET method</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>If you are only requesting to receive data from a web server (a <code>GET</code> request), and the server does not need an API key
or any authorization headers, and no data is being uploaded then any of these can be used.</p> <p>It is only if you start to upload data or customize headers that you need to add a Headers object or define the body
contents.</p> <h2 id="ide-api-library-framework-and-sdk"><a href="#ide-api-library-framework-and-sdk" class="header-anchor">#</a> IDE, API, Library, Framework, and SDK</h2> <p>Ever wonder what the difference is between these five things - <code>IDE</code>, <code>API</code>, <code>Library</code>, <code>Framework</code>, and <code>SDK</code>?</p> <p>While there are different interpretations with different types of programming and disagreements between developers about
the finer points, here is a general reference to what each is:</p> <p><strong>IDE</strong> is an Integrated Development Environment. This is a text editor on steroids. It has features that help
developers write and compile their code, as well as, manage all their projects. Usually, they have integrations with
Source Control (Git) too.</p> <p><strong>API</strong> is an Application Programming Interface. This is a group of functions or server-side endpoints that let another
program access a service or data-source.</p> <p><strong>Library</strong> is one or more files that use the same programming language as your project. They can be included in your
project to provide pre-tested code that will speed up your development work.</p> <p><strong>Framework</strong> is similar to a library but will typically <em>also</em> include UI components, design assets, best practice
guidance, and conventions to follow.</p> <p><strong>SDK</strong> is a software development kit. It tends to be the largest of all of these. It will often include a library or
framework. Most importantly, it will include tools that you need in order to develop for your target platforms, such as
a compiler or testing tools.</p> <h2 id="jsonplaceholder"><a href="#jsonplaceholder" class="header-anchor">#</a> JSONPlaceHolder</h2> <p>This is a free website that developers often use to test that their code is working.</p> <p><a href="http://jsonplaceholder.typicode.com/" target="_blank" rel="noopener noreferrer">http://jsonplaceholder.typicode.com/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>They have a static series of datasets that will be returned when you make fetch calls to their endpoints.</p> <ul><li>Users <a href="http://jsonplaceholder.typicode.com/users" target="_blank" rel="noopener noreferrer">http://jsonplaceholder.typicode.com/users<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 10 users</li> <li>Albums <a href="http://jsonplaceholder.typicode.com/albums" target="_blank" rel="noopener noreferrer">http://jsonplaceholder.typicode.com/albums<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 100 albums</li> <li>Photos <a href="http://jsonplaceholder.typicode.com/photos" target="_blank" rel="noopener noreferrer">http://jsonplaceholder.typicode.com/photos<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 5000 photos</li> <li>Todo <a href="http://jsonplaceholder.typicode.com/todos" target="_blank" rel="noopener noreferrer">http://jsonplaceholder.typicode.com/todos<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 200 todos</li> <li>Posts <a href="http://jsonplaceholder.typicode.com/posts" target="_blank" rel="noopener noreferrer">http://jsonplaceholder.typicode.com/posts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 100 posts</li> <li>Comments <a href="http://jsonplaceholder.typicode.com/comments" target="_blank" rel="noopener noreferrer">http://jsonplaceholder.typicode.com/comments<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 500 comments</li></ul> <p>You can make a <code>GET</code> request to any of those endpoints and you will get the same response each time.</p> <p>If you want to pretend to do an upload a new object of one of those types then make a <code>POST</code> request and include the
data you want to upload in the <code>body</code> of your request. You will get a <code>201 success</code> message from the server. It doesn't
actually add anything to the dataset. It just pretends.</p> <p>If you want to get the details of a single item from one of those sets then just add the id of the item you want at the
end of the endpoint and make a <code>GET</code> request.</p> <p>You can also make <code>DELETE</code> requests with the id to pretend to delete one or <code>PUT</code> or <code>PATCH</code> requests with the id to
pretend to do an update.</p> <h2 id="randomfox"><a href="#randomfox" class="header-anchor">#</a> RandomFox</h2> <p><a href="https://randomfox.ca/" target="_blank" rel="noopener noreferrer">https://randomfox.ca/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Need a random image of a fox? We got you fam!</p> <p>Make a <code>fetch</code> GET request to this endpoint <a href="https://randomfox.ca/floof/" target="_blank" rel="noopener noreferrer">https://randomfox.ca/floof/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and you will be
sent a JSON response that looks like this:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://randomfox.ca/images/8.jpg&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;link&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://randomfox.ca/?i=8&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="randomdog"><a href="#randomdog" class="header-anchor">#</a> RandomDog</h2> <p><a href="https://random.dog/" target="_blank" rel="noopener noreferrer">https://random.dog/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Need an image of a random dog? Search no more!</p> <p>Send a GET request with <code>fetch</code> to this endpoint <a href="https://random.dog/woof.json" target="_blank" rel="noopener noreferrer">https://random.dog/woof.json<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>You will get a JSON response that looks like this:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;fileSizeBytes&quot;</span><span class="token operator">:</span> <span class="token number">95056</span><span class="token punctuation">,</span>
  <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://random.dog/1f3fcc44-3b7c-4268-92a9-a6faa6f75547.jpg&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="creating-dynamic-content"><a href="#creating-dynamic-content" class="header-anchor">#</a> Creating Dynamic Content</h2> <p>Once you have a grasp on how to match a fetch request to a web server, then it is time to start looking at how to update
your webpage content with the data that came back from the webserver.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//make a request to an API that will return some JSON data</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Data request failed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">body</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//body will be the object with the data from the server</span>
    <span class="token comment">//Where do you want to add the new data?</span>
    <span class="token comment">//Are you replacing old HTML or adding to existing HTML?</span>
    <span class="token comment">//Is there a template to use in building the new HTML?</span>
    <span class="token comment">//Which approach do you want to use when building the HTML?</span>
    <span class="token comment">//Does `body` contain an array to loop through?</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//handle the error somehow</span>
    <span class="token comment">//tell the user</span>
    <span class="token comment">//write a message about the failure...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><p>We discussed best practices for dynamically adding new HTML from an array
<a href="/F2022/modules/week5/dom-2/#dynamic-html-best-practices">/modules/week5/dom-2/#dynamic-html-best-practices</a> in week 5.</p></blockquote> <div title="build HTML with fetch" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/SRR2O0hCCAE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <div title="Real World Fetch" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/QYQs-Z4_tcs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <div title="Promise all and multiple files" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/K6fFv_D99CE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="reddit-rest-api"><a href="#reddit-rest-api" class="header-anchor">#</a> Reddit REST API</h2> <p>One of the cool features built into the Reddit website, is that you can take nearly every URL from any subreddit and
just add <code>.json</code> to the end of the URL to load a JSON file version of all the information on the page.</p> <p>This means that you can make <code>fetch()</code> calls to the home page of a subreddit and load a JSON file with a current list of
all the posts to that subreddit.</p> <p>Say, for example you took the LearnJavaScript subreddit page - <code>https://www.reddit.com/r/learnjavascript/</code> and then
replace the final <code>/</code> with <code>.json</code> at the end of that string. Also switch the <code>www</code> to <code>api</code>. Then you would have the
url to use in the fetch call.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.reddit.com/r/learnjavascript.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Unable to fetch the URL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//data will be the JavaScript object created from the JSON string returned from reddit.com</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Try just pasting this URL <code>https://api.reddit.com/r/learnjavascript/.json</code> into your browser and see the results that
are loaded.</p> <h2 id="github-rest-api"><a href="#github-rest-api" class="header-anchor">#</a> Github REST API</h2> <p><a href="https://docs.github.com/en/rest/repos" target="_blank" rel="noopener noreferrer">Github Public Repo REST APIs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Github has a number of public APIs that we can use to fetch information about Repositories or Users or more. You can
make a <code>fetch</code> call to a url like <code>https://api.github.com/users/prof3ssorSt3v3/repos</code> to get a JSON file with a list of
the all the repos for Steve Griffith's Github account. The URL <code>https://api.github.com/users/maddprof1/repos</code> returns a
JSON file with a list of all the repos for Tony Davidson.</p> <p>So, as long as you know the username, you can get a list of all that person's public repos.</p> <p>Try loading either of those URLs into the browser and look at the JSON results that are displayed.</p> <p>Github also provides their own JavaScript library called <a href="https://github.com/octokit/octokit.js/#readme" target="_blank" rel="noopener noreferrer">Octokit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which
can be used to make calls to the Github APIs.</p> <p>With the <strong>Octokit</strong> library, instead of calling <code>fetch</code>, you would import the library, create an Octokit object and
then call the <code>request()</code> method, with the desired endpoint URL.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Octokit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://cdn.skypack.dev/octokit'</span><span class="token punctuation">;</span>
<span class="token comment">//import the Octokit function</span>
<span class="token comment">//then create an instance of the Octokit object</span>
<span class="token keyword">const</span> octokit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Octokit</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//the {} object allows for passing in of options</span>

octokit
  <span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'GET /repos/{owner}/{repo}'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">owner</span><span class="token operator">:</span> <span class="token string">'octocat'</span><span class="token punctuation">,</span> <span class="token comment">//will become the {owner} part of the url</span>
    <span class="token literal-property property">repo</span><span class="token operator">:</span> <span class="token string">'Spoon-Knife'</span><span class="token punctuation">,</span> <span class="token comment">//will become the {repo} part of the url</span>
    <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token string">'updated'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//status code</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//same as the data object you get in fetch from response.json()</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="http-cat"><a href="#http-cat" class="header-anchor">#</a> Http Cat</h2> <p>Looking for a fun way to learn and remember the Http Status Codes? <a href="https://http.cat/" target="_blank" rel="noopener noreferrer">https://http.cat/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> will give you
the full list.</p> <p>If you want a single status code with it's corresponding image, then just add the status code to the end of the url. Eg:</p> <p><a href="https://http.cat/404" target="_blank" rel="noopener noreferrer">https://http.cat/404<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://http.cat/404" alt="https://http.cat/404"></p> <h2 id="the-cat-api"><a href="#the-cat-api" class="header-anchor">#</a> The Cat API</h2> <p><a href="https://thecatapi.com/" target="_blank" rel="noopener noreferrer">The Cat API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is an API that you can use to retrieve lots of cat images. You can search for cats
based on breed or category of picture. You can retrieve random images or download them in sets called pages.</p> <p>You need to request an API key from the company. <a href="https://thecatapi.com/#pricing" target="_blank" rel="noopener noreferrer">Go here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to request a free API.</p> <p>Here is the official <a href="https://developers.thecatapi.com/" target="_blank" rel="noopener noreferrer">documentation for using the API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h4 id="authentication"><a href="#authentication" class="header-anchor">#</a> Authentication</h4> <p>Every request that you make for cat images needs to include the API key in either your Request Headers OR in the query
string.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//the header version</span>
<span class="token keyword">let</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
header<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'x-api-key'</span><span class="token punctuation">,</span> <span class="token string">'your api key goes here'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.thecatapi.com/v1/images/search?</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> header<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//the querystring version</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.thecatapi.com/v1/images/search?api_key=YOUR_API_KEY</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="get-the-category-list"><a href="#get-the-category-list" class="header-anchor">#</a> Get the Category List</h4> <p>When doing a search for images, if you want to filter by category then you first need to get the list of possible
category ids.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//url to get the list of categories</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.thecatapi.com/v1/categories</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>The resulting JSON returned from the server will be an Array of objects. Each object will contain a name and the
category id.</p> <h4 id="search-params"><a href="#search-params" class="header-anchor">#</a> Search Params</h4> <p>When your make a request for images you need to provide parameters for the search in your querystring, as part of the
request url. These are your possible querystring parameters.</p> <ul><li><strong>limit</strong> Eg: <code>?limit=20</code></li> <li><strong>page</strong> Eg: <code>?page=0</code></li> <li><strong>order</strong> Eg: <code>?order=ASC</code> or <code>DESC</code> or <code>RAND</code></li> <li><strong>has_breeds</strong> Eg: <code>has_breeds=0</code></li> <li><strong>breed_ids</strong> Eg: <code>?breed_ids=beng,abys</code></li> <li><strong>category_ids</strong> Eg: <code>?category_ids=3,5,15</code></li></ul> <p>You can find more information about these on the <code>Basics: Getting Images</code>.</p> <h4 id="example-results"><a href="#example-results" class="header-anchor">#</a> Example Results</h4> <p>After you make your HTTP Request for the search you will get a JSON response from the server.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ebv&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://cdn2.thecatapi.com/images/ebv.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;width&quot;</span><span class="token operator">:</span> <span class="token number">176</span><span class="token punctuation">,</span>
    <span class="token property">&quot;height&quot;</span><span class="token operator">:</span> <span class="token number">540</span><span class="token punctuation">,</span>
    <span class="token property">&quot;breeds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;favourite&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Your JSON data will be an array of objects. Each object will have an <code>id</code> which will also be the name of the image.
Unfortunately, there are no names associated with each image. So, if you want names then you need to generate those
yourself. However, you can use the <code>id</code> value as the key for an image in an object.</p> <h2 id="download-progress"><a href="#download-progress" class="header-anchor">#</a> Download Progress</h2> <p>The old <code>XMLHttpRequest</code> object had a <code>progress</code>event that let you measure the progress of your upload of data to the
server. This cannot be done with <code>fetch</code>. However, we are able to measure the progress of a download of any file from a
server.</p> <blockquote><p>Note: This will not work if the server is not sending the <code>content-length</code> header with it's response. If you are
building a server-side API, it is a good idea to include <code>content-type</code> and <code>content-length</code> headers with all your
responses.</p></blockquote> <p>The <code>response.body</code> object that we get as a response to calling the <code>fetch()</code> method is a <code>ReadableStream</code> object. This
means that you are actually getting a stream of data coming from the web server.</p> <p>When the first <code>then()</code> method is triggered by <code>fetch()</code> it means that we have a <code>Response</code> object. The <code>Response</code>
object will contain all the headers from the server. However, we don't necessarily have all the contents of the
downloaded file in the <code>body</code> property.</p> <p>This is why we have to call <code>response.json()</code> or <code>response.text()</code> or <code>response.blob()</code>, which are all asynchronous
methods that return a Promise. They are ALL waiting for the rest of the <code>body</code> to be downloaded before they can extract
the content and trigger the next <code>then()</code> method.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//we now have a Response Object</span>
    <span class="token comment">//it has all the Headers</span>
    <span class="token comment">//If cached, we could have the whole file</span>
    <span class="token comment">//If not cached we are still waiting for the contents of the response.body</span>
    <span class="token comment">//call an async method to extract the contents from response.body</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//this method does not resolve until all the contents have been downloaded and extracted.</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//NOW we have all the contents extracted from the body.</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//handle errors</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>So, to determine the progress of your download from the server we need to know both the total filesize to download PLUS
the amount that you have downloaded so far.</p> <blockquote><p>This example will be specifically for a text file, like JSON, XML, or HTML. A Binary file like an image would have a
few differences with the TypedArray.</p></blockquote> <p>First we will access the <code>Reader</code> object to get each chunk of data from the stream as it is downloaded. Then we go to
the <code>Content-Length</code> header to find the size being downloaded.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//inside the first then()</span>
<span class="token comment">//get the reader</span>
<span class="token keyword">const</span> reader <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//get the total size of the file from the `Content-Length` header</span>
<span class="token keyword">const</span> totalBytes <span class="token operator">=</span> <span class="token operator">+</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// the unary plus operator in front of response.headers.get will convert the value to a Number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Unary_plus" target="_blank" rel="noopener noreferrer">MDN Reference for Unary Plus operator<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Next we want to start reading the chunks and add each of their byte sizes to a current size variable. The current size
is the number of bytes downloaded so far in the stream. We also will need an array to hold all the chunks downloaded so
far. After the loop we will combine all the chunks into a single block which will be our file body.</p> <p>We will use the <code>read()</code> method that returns an object with two properties - <code>done</code> and <code>value</code>. The <code>done</code> value is a
Boolean indicating if you have reached the end of the Stream yet. The <code>value</code> is the latest chunk of data from the
server.</p> <p>Add the <code>value.length</code> to our total bytes so far and add the latest chunk to our array of chunks.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> currentBytes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// our Array of data that makes up the whole body</span>
<span class="token comment">//create a loop that will keep looping until you tell it to stop</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> done<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">//exit the loop if the reader's `done` property is true</span>
  <span class="token punctuation">}</span>
  chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//add the newest chunk to our Array</span>
  currentBytes <span class="token operator">+=</span> value<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment">//figure out the new amount downloaded so far.</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Received </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>currentBytes<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>totalBytes<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//output the percentage or values somehow on your page</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Once the loop has been exited it means that we have the whole file. We need to take all our chunks from our Array and
put them into a single 8-bit TypedArray. This will be the actual file that we can then call methods on like <code>json()</code> or
<code>text()</code>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//after the loop</span>
<span class="token keyword">let</span> wholeFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>totalBytes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TypedArray</span>
<span class="token keyword">let</span> position <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//position in the TypedArray</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> chunk <span class="token keyword">of</span> chunks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  wholeFile<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>chunk<span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// place a chunk into the wholeFile TypedArray</span>
  position <span class="token operator">+=</span> chunk<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment">//move to the next position in the TypedArray</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>When the <code>for of</code> loop is completed, we will have a <code>wholeFile</code> <code>TypedArray</code> which will contain all the binary data for
our <code>Response.body</code>.</p> <p>The last step is to tell the browser how to read the file. In other words, is it a UTF-8 text file or a binary file,
etc. Say that we are dealing with a JSON file. We need to turn the contents of the TypedArray binary data into a UTF-8
string. Then we can parse the String from JSON to a JS Object.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//turn the TypedArray into a utf-8 String</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextDecoder</span><span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>wholeFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//parse the string as a JSON string and return to the next then()</span>
<span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The returned object created by calling <code>JSON.parse()</code> on our utf-8 string will be passed to the next <code>then()</code> method and
become that <code>content</code> variable.</p> <h3 id="using-for-await-of"><a href="#using-for-await-of" class="header-anchor">#</a> Using for await of</h3> <p>There is a new variation of <code>for of</code> called <code>for await of</code>. The new version still loops through iterable objects
returning all the values, but the iterables can be asychronous. This means you could be using Promises or fetch calls to
get the values. The <code>for await of</code> loop will wait for each value to resolve before it increments to the next one.</p> <p>Normal loops like <code>for</code>, <code>for in</code>, <code>while</code> and <code>for of</code> all aim to finish as quickly as possible. If the values that
they are looping over are asynchronous Promises then the values you see in your loop will all be <code>unresolved Promise</code>.
Which isn't very useful.</p> <p>So, in the <code>progress</code> example above with the <code>ReadableStream</code> <code>Response.body</code>, you could use a <code>for await of</code> loop
instead of the <code>while</code> loop.</p> <p>Here is the new version of all the code from above using a <code>for await of</code> loop.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//with for await (of)</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> reader <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> currentBytes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> totalBytes <span class="token operator">=</span> <span class="token operator">+</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> wholeFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>totalBytes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TypedArray</span>
    <span class="token keyword">let</span> position <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//loop while getting chunks</span>
    <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>done<span class="token punctuation">,</span> value<span class="token punctuation">}</span> <span class="token keyword">of</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//output the percentage or values somehow on your page</span>
      currentBytes <span class="token operator">+=</span> value<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment">//figure out the new amount downloaded so far.</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Received </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>currentBytes<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>totalBytes<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// add the chunk into the wholeFile TypedArray</span>
      wholeFile<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span>
      position <span class="token operator">+=</span> value<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment">//move to the next position in the TypedArray</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">//exit the loop if the reader's `done` property is true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//parse the string as a JSON string and return to the next then()</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextDecoder</span><span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>wholeFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">contents</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//we have the contents of the file as a JS Object</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span>warn<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>The last two lines inside the first <code>then()</code> are assuming that we are dealing with a text file, specifically a JSON
file.</p> <p>If you were dealing with a binary file like an image then we would want to create a <code>Blob</code> object instead of a string.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...all the other code remains the same</span>
    <span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span>wholeFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> blob<span class="token punctuation">;</span> <span class="token comment">//pass the binary large object to the second then()</span>
    <span class="token comment">// If we weren't monitoring progress then we could just use</span>
    <span class="token comment">// return response.blob();</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//blob is the BLOB object with the image data</span>
    <span class="token keyword">let</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#targetImage'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//use URL.createObjectURL to turn the binary data into something that can be loaded by an &lt;img&gt;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span>warn<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>If your <code>fetch</code> is going to be retrieving both text or binary items then you can add a test to see what kind of file is
being downloaded.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//get the content-type header</span>
  <span class="token keyword">const</span> fileType <span class="token operator">=</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//do different things depending...</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//missing a content-type header...</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fileType<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">image/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> fileType<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">video/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> fileType<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">audio/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//we are dealing with an image, audio or video file</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fileType<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'application/json'</span><span class="token punctuation">)</span> <span class="token operator">||</span> fileType<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'text/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//json, html, txt, xml</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//not one of the desired types</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO Things to do before next week.</p> <ul><li>Read all the content from <code>Modules 10.1, 10.2, and 11.1</code>.</li> <li>Continue working on the Hybrid Exercises</li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/10/2022, 10:36:42 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/F2022/modules/week10/ajax/" class="prev">
        10.1: AJAX and Fetch
      </a></span> <span class="next"><a href="/F2022/modules/week11/fetch-data/">
        11.1: Dynamic Data
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/F2022/assets/js/app.42156b92.js" defer></script><script src="/F2022/assets/js/2.309c8f6c.js" defer></script><script src="/F2022/assets/js/24.f984b5df.js" defer></script><script src="/F2022/assets/js/4.8f0492b2.js" defer></script><script src="/F2022/assets/js/6.42129677.js" defer></script>
  </body>
</html>
