<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>14.2 Project | MAD9014</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Cross-Platform Application Development">
    
    <link rel="preload" href="/F2022/assets/css/0.styles.50f415bc.css" as="style"><link rel="preload" href="/F2022/assets/js/app.42156b92.js" as="script"><link rel="preload" href="/F2022/assets/js/2.309c8f6c.js" as="script"><link rel="preload" href="/F2022/assets/js/31.b43b0ef2.js" as="script"><link rel="preload" href="/F2022/assets/js/4.8f0492b2.js" as="script"><link rel="prefetch" href="/F2022/assets/js/10.6ed74506.js"><link rel="prefetch" href="/F2022/assets/js/11.e4e57652.js"><link rel="prefetch" href="/F2022/assets/js/12.4fd9334c.js"><link rel="prefetch" href="/F2022/assets/js/13.d60171d2.js"><link rel="prefetch" href="/F2022/assets/js/14.ef5f94d3.js"><link rel="prefetch" href="/F2022/assets/js/15.89cba5d1.js"><link rel="prefetch" href="/F2022/assets/js/16.07b0adef.js"><link rel="prefetch" href="/F2022/assets/js/17.274ce64a.js"><link rel="prefetch" href="/F2022/assets/js/18.83156930.js"><link rel="prefetch" href="/F2022/assets/js/19.dd8c0299.js"><link rel="prefetch" href="/F2022/assets/js/20.905940c5.js"><link rel="prefetch" href="/F2022/assets/js/21.0ecc185a.js"><link rel="prefetch" href="/F2022/assets/js/22.8c4f615d.js"><link rel="prefetch" href="/F2022/assets/js/23.cbd124fb.js"><link rel="prefetch" href="/F2022/assets/js/24.f984b5df.js"><link rel="prefetch" href="/F2022/assets/js/25.cae0bd53.js"><link rel="prefetch" href="/F2022/assets/js/26.171c675d.js"><link rel="prefetch" href="/F2022/assets/js/27.b6b19a01.js"><link rel="prefetch" href="/F2022/assets/js/28.762bb28a.js"><link rel="prefetch" href="/F2022/assets/js/29.ba3d8131.js"><link rel="prefetch" href="/F2022/assets/js/3.0ff4921b.js"><link rel="prefetch" href="/F2022/assets/js/30.9f8ef05e.js"><link rel="prefetch" href="/F2022/assets/js/32.c63a796c.js"><link rel="prefetch" href="/F2022/assets/js/33.b7b22e5a.js"><link rel="prefetch" href="/F2022/assets/js/34.410d0f9e.js"><link rel="prefetch" href="/F2022/assets/js/35.b935e2dc.js"><link rel="prefetch" href="/F2022/assets/js/36.27336e61.js"><link rel="prefetch" href="/F2022/assets/js/37.62aa130b.js"><link rel="prefetch" href="/F2022/assets/js/38.3da4e238.js"><link rel="prefetch" href="/F2022/assets/js/39.ffcb03f3.js"><link rel="prefetch" href="/F2022/assets/js/40.b0afee99.js"><link rel="prefetch" href="/F2022/assets/js/41.eeb38dd7.js"><link rel="prefetch" href="/F2022/assets/js/42.2e322fc2.js"><link rel="prefetch" href="/F2022/assets/js/43.3d75d1e0.js"><link rel="prefetch" href="/F2022/assets/js/44.d343e4db.js"><link rel="prefetch" href="/F2022/assets/js/45.35ad5dce.js"><link rel="prefetch" href="/F2022/assets/js/46.17dcf00b.js"><link rel="prefetch" href="/F2022/assets/js/5.71716d92.js"><link rel="prefetch" href="/F2022/assets/js/6.42129677.js"><link rel="prefetch" href="/F2022/assets/js/7.ea52c00d.js"><link rel="prefetch" href="/F2022/assets/js/8.78988ea0.js"><link rel="prefetch" href="/F2022/assets/js/9.2c22e4b4.js">
    <link rel="stylesheet" href="/F2022/assets/css/0.styles.50f415bc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/F2022/" class="home-link router-link-active"><img src="/F2022/mad-d-logo-sm.png" alt="MAD9014" class="logo"> <span class="site-name can-hide">MAD9014</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/F2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/F2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/F2022/conventions/" class="nav-link">
  Conventions
</a></div><div class="nav-item"><a href="/F2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/F2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/F2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/F2022/conventions/" class="nav-link">
  Conventions
</a></div><div class="nav-item"><a href="/F2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/F2022/modules/week1/intro/" class="sidebar-link">1.1: Introduction</a></li><li><a href="/F2022/modules/week2/functions/" class="sidebar-link">2.1: Functions and Scope</a></li><li><a href="/F2022/modules/week2/flow-strings/" class="sidebar-link">2.2: Truthiness, Control Flow and Strings</a></li><li><a href="/F2022/modules/week3/math-numbers/" class="sidebar-link">3.1: Math and Numbers</a></li><li><a href="/F2022/modules/week3/dates-loops/" class="sidebar-link">3.2: Dates and Loops</a></li><li><a href="/F2022/modules/week4/arrays/" class="sidebar-link">4.1: Arrays</a></li><li><a href="/F2022/modules/week4/objects/" class="sidebar-link">4.2: Objects</a></li><li><a href="/F2022/modules/week5/dom-1/" class="sidebar-link">5.1: Document Object Model</a></li><li><a href="/F2022/modules/week5/dom-2/" class="sidebar-link">5.2: Document Object Model</a></li><li><a href="/F2022/modules/week6/events/" class="sidebar-link">6.1: Handling Events</a></li><li><a href="/F2022/modules/week7/project-structure/" class="sidebar-link">7.1: Project Structure</a></li><li><a href="/F2022/modules/week7/code-structure/" class="sidebar-link">7.2: Code Structure</a></li><li><a href="/F2022/modules/reading/" class="sidebar-link">8: Reading Week</a></li><li><a href="/F2022/modules/week9/promises/" class="sidebar-link">9.1: Promises</a></li><li><a href="/F2022/modules/week9/async/" class="sidebar-link">9.2: Asynchronous Programming</a></li><li><a href="/F2022/modules/week10/ajax/" class="sidebar-link">10.1: AJAX and Fetch</a></li><li><a href="/F2022/modules/week10/fetch-apis/" class="sidebar-link">10.2: Fetch and APIs</a></li><li><a href="/F2022/modules/week11/fetch-data/" class="sidebar-link">11.1: Dynamic Data</a></li><li><a href="/F2022/modules/week11/security/" class="sidebar-link">11.2: Fetch Security</a></li><li><a href="/F2022/modules/week12/observers/" class="sidebar-link">12.1: Observers &amp; Classes</a></li><li><a href="/F2022/modules/week12/destructure/" class="sidebar-link">12.2: Destructuring, Spead, &amp; Enumeration</a></li><li><a href="/F2022/modules/week13/storage/" class="sidebar-link">13.1: HTML5 APIs</a></li><li><a href="/F2022/modules/week13/multi-page/" class="sidebar-link">13.2: Multi-Page, SPA, and JAMStack </a></li><li><a href="/F2022/modules/week14/project-1/" class="sidebar-link">14.1: Forms &amp; Page Transitions</a></li><li><a href="/F2022/modules/week14/project-2/" aria-current="page" class="active sidebar-link">14.2: Final Project</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/F2022/modules/week14/project-2/#final-project" class="sidebar-link">Final Project</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week14/project-2/#what-to-do-this-week" class="sidebar-link">What to do this week</a></li></ul></li><li><a href="/F2022/modules/week15/" class="sidebar-link">15.1: Final Project</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title blue">
    Web Apps
  </div> <h1>14.2 Project</h1></header> <h2 id="final-project"><a href="#final-project" class="header-anchor">#</a> Final Project</h2> <h3 id="hash-vs-querystring-vs-state"><a href="#hash-vs-querystring-vs-state" class="header-anchor">#</a> Hash vs QueryString vs State</h3> <p>Three different sources that can be used to provide data to your script to dynamically control the contents of your HTML
file are: the URL <code>hash</code> value; the URL <code>querystring</code>; and the <code>state</code> property of the History object which accesses the
data stored in the History array entry associated with the current page.</p> <p><strong>Reading values from hash</strong></p> <p>To get the hash value we read the <code>hash</code> value of the <code>location</code> object.</p> <p>The contents of the <code>hash</code> string must start with a <code>#</code> but you can add whatever other information you need. If the
information you are storing has multiple parts then you need to have a separator between each part. You could use a
colon <code>:</code>, a hyphen <code>-</code>, a pipe character <code>|</code>, or a forward slash like you see in URL file and folder paths <code>/</code>. It
really is up to you which character you use.</p> <p>You would then <code>split()</code> the <code>hash</code> string on that character to get an array of parts. The first part is usually the
<code>#</code>. We would place a separator right after the <code>#</code> to make sure.</p> <p>Using the example of a hash value that could be:</p> <ul><li><code>#/</code> the base page with no user data</li> <li><code>#/users</code> show a list of users</li> <li><code>#/users/34</code> show the details of user 34</li> <li><code>#/users/add</code> show the form to add a new user</li></ul> <p>We would take the hash and split it, then ignore the first value in the array. Based on the length, size and datatype of
the other values we can determine what to do.</p> <p>This is a good opportunity to use destructuring to discard the first value.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> hash <span class="token operator">=</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> type<span class="token punctuation">,</span> action<span class="token punctuation">]</span> <span class="token operator">=</span> hash<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">&amp;&amp;</span> type <span class="token operator">===</span> <span class="token string">'users'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//users section</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> action <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> userid <span class="token operator">=</span> action<span class="token punctuation">;</span>
      <span class="token comment">//get the details for userid</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>action <span class="token operator">===</span> <span class="token string">'add'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//show the form to add a new user</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//unknown or future command like delete</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//show the list of users</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">//base page with no user data</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>Reading values from QueryStrings</strong></p> <p>The process for getting data out of the <code>QueryString</code> is very much like the one for <code>hash</code> strings. The difference with
the <code>querystring</code> is that the separators are predetermined and each part comes as a name-value pair.</p> <p>The best approach is to create a <code>URLSearchParams</code> object with the <code>search</code> string from the <code>location</code> object.</p> <p>Using the same functionality as the hash examples:</p> <ul><li>`` the base page with no user data. no querystring</li> <li><code>?users</code> show a list of users</li> <li><code>?users=34</code> show the details of user 34</li> <li><code>?users=add</code> show the form to add a new user</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>location<span class="token punctuation">.</span>search <span class="token operator">&amp;&amp;</span> params<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'add'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//show the form to add a new user</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> userid <span class="token operator">=</span> <span class="token operator">+</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//show the details for a specific user</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//unknown or future command like delete</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">//base page with no user data</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>Reading values from State</strong></p> <p>The third approach is to save data in the <code>state</code> property of each History array entry. We can do this with the
<code>history.pushState()</code> and <code>history.replaceState()</code> methods. This makes it ideal for Single Page Applications (SPA).</p> <p>The value that we put into <code>state</code> can be pretty much anything that you would put into an object literal except for HTML
references or functions.</p> <p>Again, using the same example as above, we could add this data along with the <code>index.html</code> url as history entries like
this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> state <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> state1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> state2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token number">34</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> state3 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token string">'add'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'./index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span>state1<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'./index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span>state2<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'./index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span>state3<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'./index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Once the data is there, we can read that data from inside of either the <code>DOMContentLoaded</code> or <code>popstate</code> event handlers
by checking the value of the <code>history.state</code> property.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> state <span class="token operator">=</span> history<span class="token punctuation">.</span>state<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">&amp;&amp;</span> <span class="token string">'users'</span> <span class="token keyword">in</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>users <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//show all users</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>users <span class="token operator">===</span> <span class="token string">'add'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//show the form to add a new user</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> state<span class="token punctuation">.</span>users <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> userid <span class="token operator">=</span> state<span class="token punctuation">.</span>users<span class="token punctuation">;</span>
      <span class="token comment">//show the details for a specific user</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//unknown or future command like delete</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//base page</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>The downside of the <code>history.state</code> approach is that you cannot pass data directly to <code>history.state</code> when you are using
<code>location.href</code> or a form or an anchor tag to navigate to another page. You can only put the data into <code>history.state</code>
through the <code>pushState()</code> or <code>replaceState()</code> methods.</p> <h3 id="navigating-between-pages"><a href="#navigating-between-pages" class="header-anchor">#</a> Navigating between Pages</h3> <p>To navigate from one page to another we can let a user click an <code>&lt;a&gt;</code> tag or submit a form and then not
<code>ev.preventDefault()</code>.</p> <p>Alternatively, in the JavaScript we can change the current url and add a new history array entry at the same time by
using the <code>Location</code> object, like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">'//www.example.com/index.html'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>If you are building a Single Page Application (SPA) then you are usually using CSS to hide and show <code>&lt;div&gt;</code> or
<code>&lt;section&gt;</code> elements on the page to hide and reveal content. Typically this is also combined with a <code>fetch()</code> call to
get new data to display on the page.</p> <p>Another less common approach is to use a <code>fetch()</code> call to retrieve a new HTML file. The user would click on a
navigation element of some kind to call a function that fetches the new HTML. Once the HTML has been retrieved, a
<code>DOMParser</code> is used to extract the content from the new HTML file. Then any desired part of the content can be loaded
into the current webpage body.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> anchor <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'navLink'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  anchor<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> getPageTwo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getPageTwo</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ev<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span> ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>href<span class="token punctuation">;</span> <span class="token comment">//extract the url from the anchor tag that was clicked</span>
  <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NetworkError</span><span class="token punctuation">(</span><span class="token string">'Navigation error'</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//extract the String from the file with all the HTML</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">htmlStr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> doc <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parseFromString</span><span class="token punctuation">(</span>htmlStr<span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//doc is the HTML DOM for the fetched file</span>
      <span class="token keyword">let</span> newMain <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//get the &lt;main&gt; from the fetched doc and copy it</span>
      <span class="token comment">//find the current &lt;main&gt; element to be replaced</span>
      document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//add the new main element to the body</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>newMain<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//handle errors</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="events-popstate-and-domcontentloaded"><a href="#events-popstate-and-domcontentloaded" class="header-anchor">#</a> Events popstate and DOMContentLoaded</h3> <p>The events that we will listen for during navigation in our app are <code>popstate</code> and <code>DOMContentLoaded</code>. The <code>popstate</code>
event occurs each time the user actually navigates to a new history entry. This could mean clicking the browser back or
forward button. It could also be the user clicking an anchor tag or submitting a form and the default behaviour is not
prevented in your script with <code>ev.preventDefault()</code>. It could also be triggered if the user manually types a new hash
value for a url into the location bar of the browser. Basically, we are looking for the browser to move to a new entry
in the history array.</p> <blockquote><p>Do NOT confuse navigating with <code>location.href</code> or <code>history.go()</code> or the user typing a new url in the location bar with
the <code>pushState()</code> method that changes what is written in the location bar and creates a new History array entry.
<code>pushState()</code> is not actually moving to a new entry, just creating one.</p></blockquote> <p>The <code>DOMContentLoaded</code> event is the one we use to run a function on every initial load of a page.</p> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO Things to do before next week.</p> <ul><li>Read all the content from <code>Modules 14.1, 14.2</code>.</li> <li>Work on your Final Project</li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/4/2022, 2:30:39 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/F2022/modules/week14/project-1/" class="prev">
        14.1: Forms &amp; Page Transitions
      </a></span> <span class="next"><a href="/F2022/modules/week15/">
        15.1: Final Project
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/F2022/assets/js/app.42156b92.js" defer></script><script src="/F2022/assets/js/2.309c8f6c.js" defer></script><script src="/F2022/assets/js/31.b43b0ef2.js" defer></script><script src="/F2022/assets/js/4.8f0492b2.js" defer></script>
  </body>
</html>
