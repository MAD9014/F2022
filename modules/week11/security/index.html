<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>11.2 API Security | MAD9014</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Cross-Platform Application Development">
    
    <link rel="preload" href="/F2022/assets/css/0.styles.50f415bc.css" as="style"><link rel="preload" href="/F2022/assets/js/app.42156b92.js" as="script"><link rel="preload" href="/F2022/assets/js/2.309c8f6c.js" as="script"><link rel="preload" href="/F2022/assets/js/12.4fd9334c.js" as="script"><link rel="preload" href="/F2022/assets/js/4.8f0492b2.js" as="script"><link rel="preload" href="/F2022/assets/js/6.42129677.js" as="script"><link rel="prefetch" href="/F2022/assets/js/10.6ed74506.js"><link rel="prefetch" href="/F2022/assets/js/11.e4e57652.js"><link rel="prefetch" href="/F2022/assets/js/13.d60171d2.js"><link rel="prefetch" href="/F2022/assets/js/14.ef5f94d3.js"><link rel="prefetch" href="/F2022/assets/js/15.89cba5d1.js"><link rel="prefetch" href="/F2022/assets/js/16.07b0adef.js"><link rel="prefetch" href="/F2022/assets/js/17.274ce64a.js"><link rel="prefetch" href="/F2022/assets/js/18.83156930.js"><link rel="prefetch" href="/F2022/assets/js/19.dd8c0299.js"><link rel="prefetch" href="/F2022/assets/js/20.905940c5.js"><link rel="prefetch" href="/F2022/assets/js/21.0ecc185a.js"><link rel="prefetch" href="/F2022/assets/js/22.8c4f615d.js"><link rel="prefetch" href="/F2022/assets/js/23.cbd124fb.js"><link rel="prefetch" href="/F2022/assets/js/24.f984b5df.js"><link rel="prefetch" href="/F2022/assets/js/25.cae0bd53.js"><link rel="prefetch" href="/F2022/assets/js/26.171c675d.js"><link rel="prefetch" href="/F2022/assets/js/27.b6b19a01.js"><link rel="prefetch" href="/F2022/assets/js/28.762bb28a.js"><link rel="prefetch" href="/F2022/assets/js/29.ba3d8131.js"><link rel="prefetch" href="/F2022/assets/js/3.0ff4921b.js"><link rel="prefetch" href="/F2022/assets/js/30.9f8ef05e.js"><link rel="prefetch" href="/F2022/assets/js/31.b43b0ef2.js"><link rel="prefetch" href="/F2022/assets/js/32.c63a796c.js"><link rel="prefetch" href="/F2022/assets/js/33.b7b22e5a.js"><link rel="prefetch" href="/F2022/assets/js/34.410d0f9e.js"><link rel="prefetch" href="/F2022/assets/js/35.b935e2dc.js"><link rel="prefetch" href="/F2022/assets/js/36.27336e61.js"><link rel="prefetch" href="/F2022/assets/js/37.62aa130b.js"><link rel="prefetch" href="/F2022/assets/js/38.3da4e238.js"><link rel="prefetch" href="/F2022/assets/js/39.ffcb03f3.js"><link rel="prefetch" href="/F2022/assets/js/40.b0afee99.js"><link rel="prefetch" href="/F2022/assets/js/41.eeb38dd7.js"><link rel="prefetch" href="/F2022/assets/js/42.2e322fc2.js"><link rel="prefetch" href="/F2022/assets/js/43.3d75d1e0.js"><link rel="prefetch" href="/F2022/assets/js/44.d343e4db.js"><link rel="prefetch" href="/F2022/assets/js/45.35ad5dce.js"><link rel="prefetch" href="/F2022/assets/js/46.17dcf00b.js"><link rel="prefetch" href="/F2022/assets/js/5.71716d92.js"><link rel="prefetch" href="/F2022/assets/js/7.ea52c00d.js"><link rel="prefetch" href="/F2022/assets/js/8.78988ea0.js"><link rel="prefetch" href="/F2022/assets/js/9.2c22e4b4.js">
    <link rel="stylesheet" href="/F2022/assets/css/0.styles.50f415bc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/F2022/" class="home-link router-link-active"><img src="/F2022/mad-d-logo-sm.png" alt="MAD9014" class="logo"> <span class="site-name can-hide">MAD9014</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/F2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/F2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/F2022/conventions/" class="nav-link">
  Conventions
</a></div><div class="nav-item"><a href="/F2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/F2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/F2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/F2022/conventions/" class="nav-link">
  Conventions
</a></div><div class="nav-item"><a href="/F2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/F2022/modules/week1/intro/" class="sidebar-link">1.1: Introduction</a></li><li><a href="/F2022/modules/week2/functions/" class="sidebar-link">2.1: Functions and Scope</a></li><li><a href="/F2022/modules/week2/flow-strings/" class="sidebar-link">2.2: Truthiness, Control Flow and Strings</a></li><li><a href="/F2022/modules/week3/math-numbers/" class="sidebar-link">3.1: Math and Numbers</a></li><li><a href="/F2022/modules/week3/dates-loops/" class="sidebar-link">3.2: Dates and Loops</a></li><li><a href="/F2022/modules/week4/arrays/" class="sidebar-link">4.1: Arrays</a></li><li><a href="/F2022/modules/week4/objects/" class="sidebar-link">4.2: Objects</a></li><li><a href="/F2022/modules/week5/dom-1/" class="sidebar-link">5.1: Document Object Model</a></li><li><a href="/F2022/modules/week5/dom-2/" class="sidebar-link">5.2: Document Object Model</a></li><li><a href="/F2022/modules/week6/events/" class="sidebar-link">6.1: Handling Events</a></li><li><a href="/F2022/modules/week7/project-structure/" class="sidebar-link">7.1: Project Structure</a></li><li><a href="/F2022/modules/week7/code-structure/" class="sidebar-link">7.2: Code Structure</a></li><li><a href="/F2022/modules/reading/" class="sidebar-link">8: Reading Week</a></li><li><a href="/F2022/modules/week9/promises/" class="sidebar-link">9.1: Promises</a></li><li><a href="/F2022/modules/week9/async/" class="sidebar-link">9.2: Asynchronous Programming</a></li><li><a href="/F2022/modules/week10/ajax/" class="sidebar-link">10.1: AJAX and Fetch</a></li><li><a href="/F2022/modules/week10/fetch-apis/" class="sidebar-link">10.2: Fetch and APIs</a></li><li><a href="/F2022/modules/week11/fetch-data/" class="sidebar-link">11.1: Dynamic Data</a></li><li><a href="/F2022/modules/week11/security/" aria-current="page" class="active sidebar-link">11.2: Fetch Security</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#security" class="sidebar-link">Security</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#cookies" class="sidebar-link">Cookies</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#headers" class="sidebar-link">Headers</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#csp" class="sidebar-link">CSP</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#using-the-script-integrity-attribute" class="sidebar-link">Using the Script integrity Attribute</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#cors" class="sidebar-link">CORS</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#authentication-and-jwt" class="sidebar-link">Authentication and JWT</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#_2fa" class="sidebar-link">2FA</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#web-authentication-api" class="sidebar-link">Web Authentication API</a></li><li class="sidebar-sub-header"><a href="/F2022/modules/week11/security/#what-to-do-this-week" class="sidebar-link">What to do this week</a></li></ul></li><li><a href="/F2022/modules/week12/observers/" class="sidebar-link">12.1: Observers &amp; Classes</a></li><li><a href="/F2022/modules/week12/destructure/" class="sidebar-link">12.2: Destructuring, Spead, &amp; Enumeration</a></li><li><a href="/F2022/modules/week13/storage/" class="sidebar-link">13.1: HTML5 APIs</a></li><li><a href="/F2022/modules/week13/multi-page/" class="sidebar-link">13.2: Multi-Page, SPA, and JAMStack </a></li><li><a href="/F2022/modules/week14/project-1/" class="sidebar-link">14.1: Forms &amp; Page Transitions</a></li><li><a href="/F2022/modules/week14/project-2/" class="sidebar-link">14.2: Final Project</a></li><li><a href="/F2022/modules/week15/" class="sidebar-link">15.1: Final Project</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title green">
    Programming with APIs
  </div> <h1>11.2 API Security</h1></header> <h2 id="security"><a href="#security" class="header-anchor">#</a> Security</h2> <p>Security for Web Apps is a broad topic with lots to learn. This week we will be talking about a number of the elements
that you should consider when designing the security for your app.</p> <div class="custom-block tip"><p class="custom-block-title">Best Practice</p> <p>üëç Never trust data that is coming from the user. Whether it is something written in the querystring or a form input,
always do at least basic validation on that text.</p> <p>üëç Never store passwords in the browser.</p> <p>üëç Never send passwords from the server to the client.</p></div> <h2 id="cookies"><a href="#cookies" class="header-anchor">#</a> Cookies</h2> <p>Cookies have been available as Strings that get created and passed with HTTP Requests and Responses since the early days
of the web. In the Requests and Responses, they are sent as a <code>Header</code> value.</p> <p>Practically every request that the browser makes for any file will have the cookie header sent along with the request.</p> <p>In the browser they are stored inside <code>document.cookie</code>. We will use <code>document.cookie</code> to both get and set the values of
cookies.</p> <p>The format of the cookie string is like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">'key=value;path=/;domain=localhost;max-age=30000;secure;samesite'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Just like localStorage there is a <code>key</code> and a <code>value</code>. The <code>value</code> must be URL encoded, just like values you put in the
queryString.</p> <h3 id="path"><a href="#path" class="header-anchor">#</a> Path</h3> <p>Be default, cookies apply to the root folder of your website. However we can add to this <code>path</code> value to restrict the
cookies to a smaller part of our website.</p> <h3 id="domain"><a href="#domain" class="header-anchor">#</a> Domain</h3> <p>By default, the <code>domain</code> value will be the domain of the HTML file. However, we can restrict it further to a specific
subdomain if we want.</p> <h3 id="max-age"><a href="#max-age" class="header-anchor">#</a> Max-Age</h3> <p>The <code>max-age</code> part of the cookie String will be the number of seconds that the cookie is to be considered valid.</p> <h3 id="secure"><a href="#secure" class="header-anchor">#</a> Secure</h3> <p>If the <code>secure</code> value exists it means the cookie can only be accessed or set over <code>https</code>.</p> <h3 id="same-site"><a href="#same-site" class="header-anchor">#</a> Same-site</h3> <p>If the <code>same-site</code> value exists then the cookie is only to be sent with requests for files that are going to the same
domain as the original HTML file.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie" target="_blank" rel="noopener noreferrer">MDN Reference for document.cookie<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div title="Understanding Browser Cookies" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/j0PpT96EFeg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <div title="Fetch, CORS, and Cookies" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/34wC1C61lg0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="headers"><a href="#headers" class="header-anchor">#</a> Headers</h2> <p>The full notes about how to work with Headers are back in <a href="/F2022/modules/week10/ajax/">Module 10.1</a>.</p> <p>Headers are included as a topic under security because you will often have to include your API Key as a header. It
depends on who designed the API. They might want the API Key in the querystring. They might want it as a Header entry.
They might want a value in the querystring plus a header entry.</p> <p>When you start to work with JSON Web Tokens (JWT), you will be passing a JSON String that has been encoded as a base-64
string through a header called <code>Authentication</code>. You will also be reading the header when it gets sent from the server.</p> <p>The <code>Authentication</code> server is also used, less commonly, for other types of authorization methods like
username-password.</p> <div title="base-64" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/SARf0c-D8BU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="csp"><a href="#csp" class="header-anchor">#</a> CSP</h2> <p>There is a <code>meta</code> tag that you should put into ALL your websites and web apps and hybrid apps. It is a security feature
to protect your users.</p> <p>It has the <code>http-equiv</code> attribute set to <code>Content-Security-Policy</code> and then a <code>content</code> attribute with all the possible
values of where the browser is allowed to load different types of resources from.</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Security-Policy<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default-src https: ;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The value inside <code>content</code> is broken up into different categories like <code>default-src</code>, <code>img-src</code>, <code>style-src</code>,
<code>font-src</code>, <code>media-src</code>, and <code>connect-src</code>. After each category name you put one or more values for allowed sources for
that type of content. After each source list you put a semi-colon.</p> <p>The <code>http-equiv</code> attribute means that this is actually a header that could be sent from the server too.</p> <p>See the CSP website for the full list of categories and values.
<a href="https://content-security-policy.com/" target="_blank" rel="noopener noreferrer">CSP website official reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div title="csp intro" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/1-sx4AmjGCI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <p>You should put this <code>meta</code> tag into EVERY webpage you build.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" target="_blank" rel="noopener noreferrer">MDN CSP reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.owasp.org/index.php/Content_Security_Policy_Cheat_Sheet" target="_blank" rel="noopener noreferrer">OWASP CSP cheatsheet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://hacks.mozilla.org/2016/02/implementing-content-security-policy/" target="_blank" rel="noopener noreferrer">Mozilla Hacks guide to CSP<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>When things go wrong with your Content-Security-Policy you will see notifications in the JavaScript console in the
browser.</p> <p><img src="/F2022/assets/img/csp-screenshot.0cc9faa3.png" alt="CSP screenshot"></p> <p>In this screenshot it is saying that it cannot load the stylesheet because the <code>style-src</code> is set to <code>&quot;none&quot;</code>.</p> <p>When you run into problems with the CSP, you should just respond to each error separately by adding a new category or
updating a category to include a specific location. While you can just put everything into default and accept anything
this defeats the purpose and provides no security for your users.</p> <h2 id="using-the-script-integrity-attribute"><a href="#using-the-script-integrity-attribute" class="header-anchor">#</a> Using the Script integrity Attribute</h2> <p>With <code>script</code> tags, we can add an integrity attribute which helps protect our users further. This attribute value also
needs to be added to your CSP tag.</p> <div title="script integrity" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/5a3LthQ2xCI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="cors"><a href="#cors" class="header-anchor">#</a> CORS</h2> <p>CORS stands for Cross-Origin Resource Sharing. It refers to the process by which the browser can make HTTP Requests to
load an HTML file from one domain and then other things like images, fonts, stylesheets, and scripts from different
domains.</p> <p>If the browser is making the request based on what it read in an HTML or CSS file then this can be done freely.</p> <p>If the cross-domain request is coming from some JavaScript code then there are restrictions in place.</p> <p>JavaScript can use the <code>Fetch API</code> or <code>XMLHttpRequest</code>objects to make requests for resources like XML, JSON, text,
images, stylesheets, fonts, videos, audio files, etc. However, we have to follow a restrictive list of rules to be able
to make those requests.</p> <h3 id="headers-2"><a href="#headers-2" class="header-anchor">#</a> Headers</h3> <p>When you configure the <code>fetch( )</code> call with the Request and Headers objects to request a resource on a different server
the only predefined headers that can be set are: <code>Accept</code>, <code>Content-Type</code>, <code>Accept-Language</code>, and <code>Content-Language</code>. No
other headers can be altered for a CORS request. You can add your own custom headers like <code>X-Steve-Is-Awesome</code> without
impacting CORS.</p> <p><code>Accept</code> tells the server what types of files you are willing to accept as a response. <code>Content-type</code> tells the server
what type of file you are sending. The only three values allowed for <code>Content-Type</code> are <code>text/plain</code>,
<code>multipart/form-data</code>, or <code>x-www-form-urlencoded</code>.</p> <h3 id="mode"><a href="#mode" class="header-anchor">#</a> Mode</h3> <p>When using the Fetch API we can actually set the CORS <code>mode</code> for the <code>request</code>. Basically we are going to tell the
server that we do or do not want to make a cross-domain request.</p> <p>Inside our Request options we define the mode like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'cors'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The <code>mode</code> can be <code>&quot;cors&quot;</code>, <code>&quot;same-origin&quot;</code>, or <code>&quot;no-cors&quot;</code>. If we set it to <code>&quot;cors&quot;</code> then we are telling the browser to
look for the proper permissions to come back from the remote webserver telling us that CORS is allowed. If we set it to
<code>&quot;same-origin&quot;</code> then we are telling the browser that it should prevent the JavaScript from making calls to any domain
except the one where the HTML came from. <code>&quot;no-cors&quot;</code> tries to make an opaque attempt to get external sources but does
not currently work within the global scope of the page.</p> <div title="Cross-Origin Fetches" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/vfAHa5GBLio" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h3 id="behind-the-scenes"><a href="#behind-the-scenes" class="header-anchor">#</a> Behind the Scenes</h3> <p>When you make a CORS AJAX call from your JavaScript code there are actually two requests being made. An initial request
called a <code>pre-flight</code> request gets sent from the browser to the server. This request includes a header providing the
domain from which the request is being made.</p> <p>For the communication between the server and the browser to finish properly, the server needs to respond to the initial
preflight request with a Response that includes a header called <code>Access-Control-Allow-Origin</code>. The value for this header
must match exactly your URL or be set to a wildcard.</p> <p>With Apache as your webserver, we can create a settings file called <code>.htaccess</code> and inside that file add this line:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Header set Access-Control-Allow-Origin &quot;*&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This will create the required header to allow for cross origin requests.</p> <p>The <code>.htaccess</code> file must be in the folder or a parent folder for the resource being requested.</p> <p>Even if you are not using Apache as your web server, the <code>Access-Control-Allow-Origin</code> header still needs to be sent
from the server to the client.</p> <p>There is also an <code>Access-Control-Allow-Headers</code> header that can hold a list of the headers which are allowed to be sent
from the browser to the server when the actual full HTTP Request is sent (after the pre-flight request).</p> <p>The <code>Access-Control-Allow-Credentials</code> header holds a true value or is omitted. If the <code>Request.credentials</code> property is
set to <code>include</code>, then this header must be set to <code>true</code> or the browser will not be allowed to access the full
<code>Response</code> if cookies, authorization headers, or TLS client certificates are included.</p> <p>The <code>Access-Control-Allow-Methods</code> header holds a list of allowed methods that can be used for the full request after
the pre-flight request.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Headers" target="_blank" rel="noopener noreferrer">Access-Control-Allow-Headers MDN reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="what-gets-restricted"><a href="#what-gets-restricted" class="header-anchor">#</a> What Gets Restricted</h3> <p>There are actually quite a few things that can get restricted when requesting resources over CORS. For our immediate
purposes, it is important to note that a webpage from edumedia.ca making a request to darksky.net would not be allowed
to use the JSON data. This happens because the HTML file and the JSON file are coming from different servers and the
server providing the JSON is NOT setting that Access-Control-Allow-Origin header for us.</p> <p>If you set the mode to <code>&quot;same-origin&quot;</code> or <code>&quot;no-cors&quot;</code> then the request would be entirely rejected.</p> <p>If you set the mode to <code>&quot;cors&quot;</code> then the request would be sent and the JSON data returned but we would not be allowed to
use the data in our JavaScript.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener noreferrer">MDN CORS reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div title="Resolving fetch cors" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/zswi0cPMxsU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="authentication-and-jwt"><a href="#authentication-and-jwt" class="header-anchor">#</a> Authentication and JWT</h2> <p>When you need to do things like pass a username and password along with a fetch request, there are a few things you can
do.</p> <p>The following videos will be very useful to you later on when you start using JWT in MAD9124 and need to accept tokens
on the client side.</p> <div title="Basic Authentication with Fetch" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/MvNT0Jis-3k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <p>Tokens has become the most common way to authenticate with <code>fetch</code> and API calls. This first video explains how tokens
can be passed through fetch.</p> <div title="Fetch with Tokens" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ju5FGcyifEA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <p>This next video shows the full life cycle of JWT (JavaScript Web Tokens) on the client and server. The Server-side part
of this will be discussed in detail in MAD9124.</p> <div title="JWT lifecycle client and server" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/QCCmWNlEkdY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="_2fa"><a href="#_2fa" class="header-anchor">#</a> 2FA</h2> <p>An acronym that you will see occasionally when reading about web security is <code>2FA</code>. It stands for Two-Factor
Authentication.</p> <p>It is a method for making your apps more resilient to attacks on your users. Basically, you have your app ask the user
for a username and a password.</p> <p>After you validate their username password combination on the server, then you send a randomly generated code to either
their email or via <code>SMS</code> as a text message to their phone.</p> <p>This way the person trying to access the site has to <strong>know</strong> the username and password AND they must <strong>possess</strong> the
device and/or have access to the person's email account.</p> <p>Recently, there has been more usage, of Authenticator apps. It is the authenticator app that is responsible for
generating the random code and then telling both the site and the user what the code is. The user then has to enter the
code and send it to the web server. The web server will validate that the code sent by the user is the same one that it
got from the Authenticator.</p> <h2 id="web-authentication-api"><a href="#web-authentication-api" class="header-anchor">#</a> Web Authentication API</h2> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API" target="_blank" rel="noopener noreferrer">MDN reference for Web Authentication<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO Things to do before next week.</p> <ul><li>Read all the content from <code>Modules 11.1, 11.2, and 12.1</code>.</li> <li>Finish working on the Hybrid Exercises</li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/23/2022, 12:49:47 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/F2022/modules/week11/fetch-data/" class="prev">
        11.1: Dynamic Data
      </a></span> <span class="next"><a href="/F2022/modules/week12/observers/">
        12.1: Observers &amp; Classes
      </a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/F2022/assets/js/app.42156b92.js" defer></script><script src="/F2022/assets/js/2.309c8f6c.js" defer></script><script src="/F2022/assets/js/12.4fd9334c.js" defer></script><script src="/F2022/assets/js/4.8f0492b2.js" defer></script><script src="/F2022/assets/js/6.42129677.js" defer></script>
  </body>
</html>
